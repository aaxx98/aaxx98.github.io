{"version":3,"file":"component---src-pages-post-mdx-frontmatter-slug-tsx-content-file-path-content-til-20260119-til-20260119-mdx-aaed68d56d11861ebee1.js","mappings":"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","sources":["webpack://aaxx98-blog/./content/til/20260119/til-20260119.mdx","webpack://aaxx98-blog/./src/pages/post/{mdx.frontmatter__slug}.tsx","webpack://aaxx98-blog/./src/components/post/post-content.tsx","webpack://aaxx98-blog/./src/components/post/toc.tsx","webpack://aaxx98-blog/./src/code/tagName.ts","webpack://aaxx98-blog/./src/components/breadcrumb.tsx","webpack://aaxx98-blog/./src/components/post/comment.tsx","webpack://aaxx98-blog/./src/components/post/post-tags.tsx"],"sourcesContent":["/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h2: \"h2\",\n    p: \"p\",\n    ul: \"ul\",\n    li: \"li\",\n    strong: \"strong\",\n    h3: \"h3\",\n    span: \"span\",\n    h4: \"h4\",\n    ol: \"ol\",\n    code: \"code\"\n  }, _provideComponents(), props.components);\n  return React.createElement(React.Fragment, null, React.createElement(_components.h2, null, \"배경\"), \"\\n\", React.createElement(_components.p, null, \"메시지 발송 시스템에서 대량의 메시지를 효율적으로 처리하기 위해 Redis Stream을 메시지큐로 활용하고, Docker 컨테이너를 통해 4개의 Consumer를 병렬로 운영하는 구조를 구축했다. 이 과정에서 발생한 여러 문제들과 해결 과정을 정리한다.\"), \"\\n\", React.createElement(_components.h2, null, \"아키텍처 개요\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"Producer\"), \": Spring 애플리케이션에서 메시지 발송 요청을 Redis Stream에 발행(admin-web)\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"Consumer\"), \": 4개의 Docker 컨테이너에서 각각 실행되며 메시지를 병렬 처리(message-sender)\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"메시지큐\"), \": Redis Stream (Consumer Group 방식)\"), \"\\n\"), \"\\n\", React.createElement(_components.h3, null, \"Docker을 이용하여 환경 구성\"), \"\\n\", React.createElement(_components.p, null, \"다음과 같이 실행하면 Consumer를 여러 개 실행시킬 수 있다.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"text\\\"><pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">docker compose up -d --build --scale message-sender=4</code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/5fc6e8a1a470e11c2c47849ca2dddd95/e113d/4message-sender.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 38.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVR42nWRiW6CQBCGff+nq2nRBFRwF/c+BPZitUmHo5LYdLKZwIYv3/zD7pNiJO/FVR6xPtHOx/TIowuJWQ+H3z21PsQ0zpVS4pxrrXPO8LprtMRcF2d8abnt3DhOtyElMwTVB90H0wO7wlDdXCuchlDf5L7CmIo8xjxfL2Z4+n7m5yO/yBijEMI5t8JnxRA3RSMOSFakAww+9iGB0w5wIvSXGcY2xmzmUlLM1Akx8DMzQLo8Z17Sgv8tM5i3zF+sBfOh4WWrrqL3YVsYNRNJrfsXrrUg0laIg5mYwcfJDDuHhZk+wijQf9k/Y38QVBOxL1FxIUjCZuexfSLG3Yxb+tuvUkot8A/f/8Qijma4hwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <picture>\\n          <source\\n              srcset=\\\"/static/5fc6e8a1a470e11c2c47849ca2dddd95/f1512/4message-sender.webp 200w,\\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/f59aa/4message-sender.webp 400w,\\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/47a22/4message-sender.webp 800w,\\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/5bb53/4message-sender.webp 1200w,\\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/3a8da/4message-sender.webp 1364w\\\"\\n              sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n              type=\\\"image/webp\\\"\\n            />\\n          <source\\n            srcset=\\\"/static/5fc6e8a1a470e11c2c47849ca2dddd95/f8f3a/4message-sender.png 200w,\\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/6a8a8/4message-sender.png 400w,\\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/7842b/4message-sender.png 800w,\\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/5ece7/4message-sender.png 1200w,\\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/e113d/4message-sender.png 1364w\\\"\\n            sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n            type=\\\"image/png\\\"\\n          />\\n          <img\\n            class=\\\"gatsby-resp-image-image\\\"\\n            src=\\\"/static/5fc6e8a1a470e11c2c47849ca2dddd95/7842b/4message-sender.png\\\"\\n            alt=\\\"message-sender=4\\\"\\n            title=\\\"\\\"\\n            loading=\\\"lazy\\\"\\n            decoding=\\\"async\\\"\\n            style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n          />\\n        </picture>\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.h2, null, \"발생한 문제와 해결 과정\"), \"\\n\", React.createElement(_components.h3, null, \"1. 트랜잭션 타이밍 이슈: Race Condition\"), \"\\n\", React.createElement(_components.h4, null, \"문제 흐름\"), \"\\n\", React.createElement(_components.ol, null, \"\\n\", React.createElement(_components.li, null, \"Producer가 DB에 메시지 상태 저장 (커밋 이전)\"), \"\\n\", React.createElement(_components.li, null, \"Redis Stream에 메시지 발행\"), \"\\n\", React.createElement(_components.li, null, \"Consumer가 메시지를 읽고 DB 조회 시도\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"커밋 전이라 데이터가 없어서 예외 발생\"), \" → 컨테이너 종료 및 재시작\"), \"\\n\", React.createElement(_components.li, null, \"4개 컨테이너가 각각 한 번씩 재시작되며 초기 4건의 미처리 발생\"), \"\\n\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"\\n\", React.createElement(_components.p, null, \"메시지 처리 중, userId 별 메시지 상태 데이터를 Insert하며 \", React.createElement(_components.code, null, \"streamProducer.publish\"), \" 발행\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"requestMessage가 종료되면 트랜잭션이 종료되어 메세지 상태 결과가 DB에 반영됨\"), \"\\n\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"java\\\"><pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">  <span class=\\\"token annotation punctuation\\\">@Transactional</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">requestMessage</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">Long</span> messageReservationId<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">markProcessing</span><span class=\\\"token punctuation\\\">(</span>messageReservationId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token class-name\\\">MessageReservation</span> reservation <span class=\\\"token operator\\\">=</span>\\n      messageReservationRepository<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">findByIdWithRelations</span><span class=\\\"token punctuation\\\">(</span>messageReservationId<span class=\\\"token punctuation\\\">)</span>\\n          <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">orElseThrow</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span>\\n\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">Long</span> userId <span class=\\\"token operator\\\">:</span> userIds<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token class-name\\\">MessageSendResult</span> result <span class=\\\"token operator\\\">=</span> messageSendResultRepository<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">save</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token class-name\\\">MessageSendResult</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">createFrom</span><span class=\\\"token punctuation\\\">(</span>reservation<span class=\\\"token punctuation\\\">,</span> userId<span class=\\\"token punctuation\\\">,</span> waitingStatus<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    streamProducer<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">publish</span><span class=\\\"token punctuation\\\">(</span>result<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getId</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span> channelTypeCode<span class=\\\"token punctuation\\\">,</span> purposeTypeCode<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token function\\\">markSent</span><span class=\\\"token punctuation\\\">(</span>reservation<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getId</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre></div>\"\n    }\n  }), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"\\n\", React.createElement(_components.p, null, \"Consumer에서는 위 트랜잭션이 끝나기 전, Stream에 전송된 메세지들을 읽으려고 시도하지만, Commit 되지 않았기 때문에 메세지 상태 정보를 찾을 수 없음 → 예외 발생 및 컨테이너가 종료되고 재실행됨\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"예외 발생시 애플리케이션 종료되는 이유: Redis Listener에서 예외를 처리하여 종료되고있음\"), \"\\n\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"java\\\"><pre class=\\\"language-java\\\"><code class=\\\"language-java\\\"><span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">process</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">MessageRequestDto</span> dto<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n\\t<span class=\\\"token class-name\\\">MessageSendResult</span> result <span class=\\\"token operator\\\">=</span>\\n        messageSendResultRepository<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">findById</span><span class=\\\"token punctuation\\\">(</span>dto<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getMessageSendResultId</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">orElseThrow</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">-></span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">IllegalArgumentException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"메시지 없음\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre></div>\"\n    }\n  }), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"\\n\", React.createElement(_components.p, null, \"그 결과, 각 message-sender 컨테이너가 한번씩 재실행되며 초기 4건의 미처리가 발생하는것으로 추측됨\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"code_id = 7: WAITING(발송 대기)\"), \"\\n\", React.createElement(_components.li, null, \"code_id = 8: SUCCESS(발송 성공)\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/69c4c67639999f15b7e92116b10e4f56/4ed45/status7.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 31%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKUlEQVR42h2OW0+DQBCF+f//xPigDzYxpi/eqj5oL0rZArVCodKydFl2l70B62AyOflmknPOeHP0c6h4hpusZHnF/0fkJU1O7Optf/1+vHzeXTzEt2s2WZGbRXm3UU8xTQtyosp7maNKdOe2p9qV3AJg0QFj3n/kZvHbT+fp5DWcxfQ+wNPl/jFuZqjAzDTaef46aKRl0rZmqIVmyjbSCNMDsFarboh3yXoT7dLMR2FelMoO5ZkSLqUdzagWlrYd0+7MNRGGSuABFFamhmCbroI4SnLQfVHJ3p0Ir5gSozlAUMtVB0mN0E2ruRq/gAtwa4fwO/XH5oOPovyIde8w4bVQqnPeYvn5/3bXGldzDQNZQvegwEIP4Tb5QtE2yUGzAoOnJJwwJa37AyL9SishpZWTAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <picture>\\n          <source\\n              srcset=\\\"/static/69c4c67639999f15b7e92116b10e4f56/f1512/status7.webp 200w,\\n/static/69c4c67639999f15b7e92116b10e4f56/f59aa/status7.webp 400w,\\n/static/69c4c67639999f15b7e92116b10e4f56/47a22/status7.webp 800w,\\n/static/69c4c67639999f15b7e92116b10e4f56/5bb53/status7.webp 1200w,\\n/static/69c4c67639999f15b7e92116b10e4f56/ff1f5/status7.webp 1330w\\\"\\n              sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n              type=\\\"image/webp\\\"\\n            />\\n          <source\\n            srcset=\\\"/static/69c4c67639999f15b7e92116b10e4f56/f8f3a/status7.png 200w,\\n/static/69c4c67639999f15b7e92116b10e4f56/6a8a8/status7.png 400w,\\n/static/69c4c67639999f15b7e92116b10e4f56/7842b/status7.png 800w,\\n/static/69c4c67639999f15b7e92116b10e4f56/5ece7/status7.png 1200w,\\n/static/69c4c67639999f15b7e92116b10e4f56/4ed45/status7.png 1330w\\\"\\n            sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n            type=\\\"image/png\\\"\\n          />\\n          <img\\n            class=\\\"gatsby-resp-image-image\\\"\\n            src=\\\"/static/69c4c67639999f15b7e92116b10e4f56/7842b/status7.png\\\"\\n            alt=\\\"초기 4건의 미처리\\\"\\n            title=\\\"\\\"\\n            loading=\\\"lazy\\\"\\n            decoding=\\\"async\\\"\\n            style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n          />\\n        </picture>\\n  </a>\\n    </span>\"\n    }\n  })), \"\\n\"), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.h4, null, \"해결방법: \", React.createElement(_components.code, null, \"TransactionSynchronizationManager\"), \"를 활용해 트랜잭션 커밋 후에 메시지 발행\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"afterCommit 콜백에서 publish 처리\", \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"afterCommit: 커밋 정상처리 후 실행되는 메소드\"), \"\\n\"), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"java\\\"><pre class=\\\"language-java\\\"><code class=\\\"language-java\\\"><span class=\\\"token annotation punctuation\\\">@Transactional</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">requestMessage</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">Long</span> messageReservationId<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">markProcessing</span><span class=\\\"token punctuation\\\">(</span>messageReservationId<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token class-name\\\">MessageReservation</span> reservation <span class=\\\"token operator\\\">=</span>\\n      messageReservationRepository<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">findByIdWithRelations</span><span class=\\\"token punctuation\\\">(</span>messageReservationId<span class=\\\"token punctuation\\\">)</span>\\n          <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">orElseThrow</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span>\\n\\n  <span class=\\\"token class-name\\\">List</span><span class=\\\"token generics\\\"><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token class-name\\\">Long</span><span class=\\\"token punctuation\\\">></span></span> resultIds <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">ArrayList</span><span class=\\\"token generics\\\"><span class=\\\"token punctuation\\\">&lt;</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// 이후 메시지 발송을 위해 발송상태ID 저장</span>\\n\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">Long</span> userId <span class=\\\"token operator\\\">:</span> userIds<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token class-name\\\">MessageSendResult</span> result <span class=\\\"token operator\\\">=</span> messageSendResultRepository<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">save</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token class-name\\\">MessageSendResult</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">createFrom</span><span class=\\\"token punctuation\\\">(</span>reservation<span class=\\\"token punctuation\\\">,</span> userId<span class=\\\"token punctuation\\\">,</span> waitingStatus<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    resultIds<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add</span><span class=\\\"token punctuation\\\">(</span>result<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getId</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token class-name\\\">TransactionSynchronizationManager</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">registerSynchronization</span><span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">TransactionSynchronization</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token annotation punctuation\\\">@Override</span>\\n        <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">afterCommit</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">Long</span> resultId <span class=\\\"token operator\\\">:</span> resultIds<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            streamProducer<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">publish</span><span class=\\\"token punctuation\\\">(</span>resultId<span class=\\\"token punctuation\\\">,</span> channelTypeCode<span class=\\\"token punctuation\\\">,</span> purposeTypeCode<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n          <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token function\\\">markSent</span><span class=\\\"token punctuation\\\">(</span>reservation<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getId</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.h3, null, \"2. ACK 처리 실패: Serializer 불일치\"), \"\\n\", React.createElement(_components.h4, null, \"문제 원인\"), \"\\n\", React.createElement(_components.p, null, \"모든 메시지가 Pending 상태에서 ACK 처리가 되지 않았다. Redis Stream에서 ACK가 성공하려면 stream key, group, messageId가 정확히 일치해야 하는데, \", React.createElement(_components.code, null, \"RedisTemplate<String, Object>\"), \" 사용 시 serializer가 명시적으로 설정되지 않아 바이트 레벨에서 불일치가 발생했다.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 428px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/pending-all.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxklEQVR42pWQSwuDMBCE/f+/zIMB9aCCSmNiHhof+EBQrHawWHoq6RyWLJuPmV3nQamQIs/zoiiyLGOMpWlKKTXGaK2llE3T4IGqlEKLWlXVeclhXGilgiDwfT9JEkIIxhgcx/G8dNz6bm+Ysbqu4zgG6Xme67pRFA3DcFrI6bpuWRakQqQwDMuy5JyjtYKnaVrXFeZg4AwYsbHwHzB+gycegX/f94jzWewXPM/ztm0g4YnY4hLOawvv+9627Xtnc2kcR5vYL9gtx6XaTQYXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <picture>\\n          <source\\n              srcset=\\\"/static/1296033dcf31d027e3e1fe598dd22eb4/f1512/pending-all.webp 200w,\\n/static/1296033dcf31d027e3e1fe598dd22eb4/f59aa/pending-all.webp 400w,\\n/static/1296033dcf31d027e3e1fe598dd22eb4/477b5/pending-all.webp 428w\\\"\\n              sizes=\\\"(max-width: 428px) 100vw, 428px\\\"\\n              type=\\\"image/webp\\\"\\n            />\\n          <source\\n            srcset=\\\"/static/1296033dcf31d027e3e1fe598dd22eb4/f8f3a/pending-all.png 200w,\\n/static/1296033dcf31d027e3e1fe598dd22eb4/6a8a8/pending-all.png 400w,\\n/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/pending-all.png 428w\\\"\\n            sizes=\\\"(max-width: 428px) 100vw, 428px\\\"\\n            type=\\\"image/png\\\"\\n          />\\n          <img\\n            class=\\\"gatsby-resp-image-image\\\"\\n            src=\\\"/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/pending-all.png\\\"\\n            alt=\\\"Pending 메시지 전 건\\\"\\n            title=\\\"\\\"\\n            loading=\\\"lazy\\\"\\n            decoding=\\\"async\\\"\\n            style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n          />\\n        </picture>\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.h4, null, \"해결 방법: \", React.createElement(_components.code, null, \"StringRedisTemplate\"), \"로 변경하여 올바른 serializer가 기본 설정되도록 함\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"변경 전: \", React.createElement(_components.code, null, \"RedisTemplate<String, Object>\")), \"\\n\", React.createElement(_components.li, null, \"변경 후: \", React.createElement(_components.code, null, \"StringRedisTemplate\"), \" 사용\"), \"\\n\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"java\\\"><pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">redisTemplate<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">opsForStream</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">acknowledge</span><span class=\\\"token punctuation\\\">(</span>\\n    message<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getStream</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span>\\n    group<span class=\\\"token punctuation\\\">,</span>\\n    message<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getId</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 352px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/242cd314fe218e01a68c46287ae972f0/ff9f2/ack.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 52.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCklEQVR42o2SV4+DQAyE+f8/jibCBg4BohfRJEQv+S6Rck8X4gdrbe14xrMr+b4fRVGapp7nGYbRNE0QBLZtZ1kmy7Lrunmevztccxyn7/vzPI/jkNq2zZ+hqmqSJPMyD8NAc5qmbdv2fV/XdVkWSjLlPM/k8xkSXZiLojBN8y7uhPPjQPUef/4fEvPQU1XVjTBuqELFZ8wfGBls8mLWdZ0lx3H8FozsOI7LsgQshMA/BrEn+Fe+kI1OwIqiWJaF4b/yDQPzUQH+ExiR2IO9mqZBDoYMvq5r5l7I7rouDEOuQitMwRnlDKJ/7fbre+A2XwLbEcIjsQWvfW0YnGDgwS2WxC1Kvsc3bj8AW4FxBpUSZ4IAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <picture>\\n          <source\\n              srcset=\\\"/static/242cd314fe218e01a68c46287ae972f0/f1512/ack.webp 200w,\\n/static/242cd314fe218e01a68c46287ae972f0/5da75/ack.webp 352w\\\"\\n              sizes=\\\"(max-width: 352px) 100vw, 352px\\\"\\n              type=\\\"image/webp\\\"\\n            />\\n          <source\\n            srcset=\\\"/static/242cd314fe218e01a68c46287ae972f0/f8f3a/ack.png 200w,\\n/static/242cd314fe218e01a68c46287ae972f0/ff9f2/ack.png 352w\\\"\\n            sizes=\\\"(max-width: 352px) 100vw, 352px\\\"\\n            type=\\\"image/png\\\"\\n          />\\n          <img\\n            class=\\\"gatsby-resp-image-image\\\"\\n            src=\\\"/static/242cd314fe218e01a68c46287ae972f0/ff9f2/ack.png\\\"\\n            alt=\\\"전 건 ACK 처리됨\\\"\\n            title=\\\"\\\"\\n            loading=\\\"lazy\\\"\\n            decoding=\\\"async\\\"\\n            style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n          />\\n        </picture>\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.h2, null, \"최적화 과정\"), \"\\n\", React.createElement(_components.h3, null, \"각 Consumer 별 메시지 분배를 균등하게 개선\"), \"\\n\", React.createElement(_components.h4, null, \"초기 문제\"), \"\\n\", React.createElement(_components.p, null, \"각 메시지 처리에 소요되는 시간은 1초인데, pollTimeout을 5초로 설정했더니 메시지가 균등하게 분배되지 않았다.\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"message-sender-1: 1건\"), \"\\n\", React.createElement(_components.li, null, \"message-sender-2: 1건\"), \"\\n\", React.createElement(_components.li, null, \"message-sender-3: N-3건\"), \"\\n\", React.createElement(_components.li, null, \"message-sender-4: 1건\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"한 번 대기 상태에 빠진 Consumer는 계속 대기하는 경향이 있었다.\"), \"\\n\", React.createElement(_components.h3, null, \"개선\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"\\n\", React.createElement(_components.ol, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"pollTimeout 조정\"), \": 5초 → 500ms로 단축\"), \"\\n\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"여전히 각 consumer 별 pending 메시지는 균일하게 분배되지 않음\"), \"\\n\", React.createElement(_components.li, null, \"onMessage에서 각 메세지 발송을 처리하기 전 우선 처리할 메시지를 consumer가 선점하고있음\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 393px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/3202a7e4e00854e9c227fda6df290b92/8a54c/poll-timeout.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 50.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAUlEQVR42o2Sx26FUAxE+f8vY4UIuSKI3lsAUV4JouU8rhQlqzALyxd5PB4bxfd913WDIEiTVNO0uqqLoqiqqizKJEn6vs/znHgcx77vx18onueZpuk4DkW6rkPLsiwMw7Is27blSWya5vMEH6sT5PRS4jiGJt6F9WFFUSSEYJZpmp4nxnH8OkFOvIH77QHujxc5TVOkVFU1DANlJrdte57n4wIUHDKYHBWyZVmsgI7btkmf0upP/P1U1nVlFjy8hheCpOs6OkryP8oU4VCSjTejrmu5G5peIg/DQDXbwjD7JEd5WZaryghCYGesmoQWl5Sxzg24JNfDMwfnl6DdFc/fFCY3QJuzBMcAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <picture>\\n          <source\\n              srcset=\\\"/static/3202a7e4e00854e9c227fda6df290b92/f1512/poll-timeout.webp 200w,\\n/static/3202a7e4e00854e9c227fda6df290b92/84562/poll-timeout.webp 393w\\\"\\n              sizes=\\\"(max-width: 393px) 100vw, 393px\\\"\\n              type=\\\"image/webp\\\"\\n            />\\n          <source\\n            srcset=\\\"/static/3202a7e4e00854e9c227fda6df290b92/f8f3a/poll-timeout.png 200w,\\n/static/3202a7e4e00854e9c227fda6df290b92/8a54c/poll-timeout.png 393w\\\"\\n            sizes=\\\"(max-width: 393px) 100vw, 393px\\\"\\n            type=\\\"image/png\\\"\\n          />\\n          <img\\n            class=\\\"gatsby-resp-image-image\\\"\\n            src=\\\"/static/3202a7e4e00854e9c227fda6df290b92/8a54c/poll-timeout.png\\\"\\n            alt=\\\"pollTimeout 조정 후\\\"\\n            title=\\\"\\\"\\n            loading=\\\"lazy\\\"\\n            decoding=\\\"async\\\"\\n            style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n          />\\n        </picture>\\n  </a>\\n    </span>\"\n    }\n  })), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"\\n\", React.createElement(_components.ol, {\n    start: \"2\"\n  }, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"batchSize 설정\"), \": 10으로 설정하여 10건씩 균일하게 할당\"), \"\\n\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"batch로 묶여있으면 1건 처리 실패 시 batch 단위가 재처리 대상이 되므로 실패율을 고려해 10건으로 설정\"), \"\\n\", React.createElement(_components.li, null, \"각 consumer가 10건씩 할당받고, 순차적으로 처리 후 균일하게 할당됨\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 428px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/batch10.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxklEQVR42pWQSwuDMBCE/f+/zIMB9aCCSmNiHhof+EBQrHawWHoq6RyWLJuPmV3nQamQIs/zoiiyLGOMpWlKKTXGaK2llE3T4IGqlEKLWlXVeclhXGilgiDwfT9JEkIIxhgcx/G8dNz6bm+Ysbqu4zgG6Xme67pRFA3DcFrI6bpuWRakQqQwDMuy5JyjtYKnaVrXFeZg4AwYsbHwHzB+gycegX/f94jzWewXPM/ztm0g4YnY4hLOawvv+9627Xtnc2kcR5vYL9gtx6XaTQYXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <picture>\\n          <source\\n              srcset=\\\"/static/1296033dcf31d027e3e1fe598dd22eb4/f1512/batch10.webp 200w,\\n/static/1296033dcf31d027e3e1fe598dd22eb4/f59aa/batch10.webp 400w,\\n/static/1296033dcf31d027e3e1fe598dd22eb4/477b5/batch10.webp 428w\\\"\\n              sizes=\\\"(max-width: 428px) 100vw, 428px\\\"\\n              type=\\\"image/webp\\\"\\n            />\\n          <source\\n            srcset=\\\"/static/1296033dcf31d027e3e1fe598dd22eb4/f8f3a/batch10.png 200w,\\n/static/1296033dcf31d027e3e1fe598dd22eb4/6a8a8/batch10.png 400w,\\n/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/batch10.png 428w\\\"\\n            sizes=\\\"(max-width: 428px) 100vw, 428px\\\"\\n            type=\\\"image/png\\\"\\n          />\\n          <img\\n            class=\\\"gatsby-resp-image-image\\\"\\n            src=\\\"/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/batch10.png\\\"\\n            alt=\\\"batchSize 10으로 설정 후\\\"\\n            title=\\\"\\\"\\n            loading=\\\"lazy\\\"\\n            decoding=\\\"async\\\"\\n            style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n          />\\n        </picture>\\n  </a>\\n    </span>\"\n    }\n  })), \"\\n\"), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, null, \"추가 고려사항 및 향후 개선 방향\"), \"\\n\", React.createElement(_components.h3, null, \"메시지 상태 초기 저장 시 CPU 사용량 이슈\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 513px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/fd73846fdae503c0e899f76153e54966/bb9ec/cpu.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 85.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMklEQVR42o1T227bMAz1///EXvcP20uKPWXYuiVNuqSObcmy5Xusu+x46CjJKTCgDxUIibF0eMhDJpr8en197ft+s9n8evy53+2+b7fTB1aklB5H/uVyTOrmKaE/XsjjCzni5kNgY61SBl275spOafF8wX8u+cDkPM/hhXXb/D54TXtZuDTncowrhjoutYNYv2YHte+iI7hGCBljm7rGWTZNZujbyyUGCRhjGGOI87DdJZguywKPQyYrWEo59MMIdXM+XK9KqTfOkDVkEVNOB7nc3Fr8AUXBfVRV1X6/P53OZVmCD1Emf7GaD7DcpmWeORfDyJuBA4+UjiMCwjRNIW2tDZjSRkglpRbC7dL50j2WmtZdXrVn0tOqgVxBUAfOsgyuAwaUVz4EtPBuEM7Mk3nKeVYzoyQDbY1ZmZMkVY7EP9XW41ekVkYrK4WerTkQnlTiBiqotRkwJCqO45EBM5gLAXf3hIOjuVCT0c9kPJFxMgYqCmo6MNRcdoKLQG6kM+VCeB/4A/hYsHPJgBA4fC88M9RMOw5qGW0sTByo5wQ0qwOflf472wNh54KBo7UO7XRDQiktO6iHk1YUvcw7SWFvBVhacdwK3AjSiR0ej4SRXqJmHcEIOg69RQjHSZYinJdVXlCUkywvEClTTFBe4IIm8ImULSUVJXU7+CGxERxCCJhEAbpztpr7GYwLUOPuPxzar7+r8TqE+XN/DMCHifPOes7/r5u3z9vh07e279rQ53/52sDOvn34CAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <picture>\\n          <source\\n              srcset=\\\"/static/fd73846fdae503c0e899f76153e54966/f1512/cpu.webp 200w,\\n/static/fd73846fdae503c0e899f76153e54966/f59aa/cpu.webp 400w,\\n/static/fd73846fdae503c0e899f76153e54966/c7c13/cpu.webp 513w\\\"\\n              sizes=\\\"(max-width: 513px) 100vw, 513px\\\"\\n              type=\\\"image/webp\\\"\\n            />\\n          <source\\n            srcset=\\\"/static/fd73846fdae503c0e899f76153e54966/f8f3a/cpu.png 200w,\\n/static/fd73846fdae503c0e899f76153e54966/6a8a8/cpu.png 400w,\\n/static/fd73846fdae503c0e899f76153e54966/bb9ec/cpu.png 513w\\\"\\n            sizes=\\\"(max-width: 513px) 100vw, 513px\\\"\\n            type=\\\"image/png\\\"\\n          />\\n          <img\\n            class=\\\"gatsby-resp-image-image\\\"\\n            src=\\\"/static/fd73846fdae503c0e899f76153e54966/bb9ec/cpu.png\\\"\\n            alt=\\\"CPU 사용량\\\"\\n            title=\\\"\\\"\\n            loading=\\\"lazy\\\"\\n            decoding=\\\"async\\\"\\n            style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n          />\\n        </picture>\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"메시지 발송 요청 시, 대략 2만건 이상의 대량의 메시지 상태를 한 번에 저장하는 과정에서 CPU 사용량이 급격히 증가하는 문제가 확인되었다.\"), \"\\n\", React.createElement(_components.p, null, \"이에 따라 메시지 상태 초기 저장 및 Stream 발행 책임을 어느 컴포넌트에서 처리할지에 대한 구조적 검토가 필요하다.\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"admin-web에서 즉시 처리\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"API 응답 지연 및 CPU 부하 집중 가능성\"), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"별도 batch 성격의 컴포넌트(billing-batch)에서 처리\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"예약 발송, 재시도 처리와 함께 순차적(batch) 처리 가능\"), \"\\n\", React.createElement(_components.li, null, \"시스템 부하 분산 측면에서 유리\"), \"\\n\"), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.h3, null, \"처리 속도 및 처리량 한계\"), \"\\n\", React.createElement(_components.p, null, \"메시지 전송 지연을 1초로 가정할 경우, 단일 Consumer는 약 10초에 9건 수준의 처리량을 보였으며, 100만 건 처리 시 약 12.9일이 소요되는 것으로 계산되었다.\"), \"\\n\", React.createElement(_components.p, null, \"Consumer를 4개로 확장하더라도 약 3.23일이 소요되어, 대량 처리 환경에서는 추가적인 처리량 개선이 필요하다.\"), \"\\n\", React.createElement(_components.p, null, \"이를 위해 다음과 같은 개선 방향을 검토 중이다.\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Batch Insert 및 Redis Pipeline 적용을 통한 RTT 감소\"), \"\\n\", React.createElement(_components.li, null, \"Consumer 내부 스레드 병렬 처리\"), \"\\n\", React.createElement(_components.li, null, \"Consumer 컨테이너 수 조절\"), \"\\n\", React.createElement(_components.li, null, \"pollTimeout, batchSize 등 Stream 설정값 튜닝\"), \"\\n\"), \"\\n\", React.createElement(_components.h3, null, \"message-sender 컨테이너 실행 시점 관리 필요성\"), \"\\n\", React.createElement(_components.p, null, \"현재 구조에서는 message-sender 컨테이너가 항상 Redis Stream을 polling하는 형태로 동작한다.\"), \"\\n\", React.createElement(_components.p, null, \"그러나 실제 메시지 발송이 발생하는 시간대가 제한적인 경우, 불필요한 polling으로 인한 리소스 낭비가 발생할 수 있다.\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"메시지 발송이 없는 시간대에도 지속적인 poll 수행\"), \"\\n\", React.createElement(_components.li, null, \"CPU 및 Redis 부하 증가 가능성\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"이에 따라 다음과 같은 방식의 개선을 고려하고 있다.\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"예약 발송 또는 재전송 요청이 발생하는 시점에만 Consumer 활성화\")), \"\\n\", React.createElement(_components.li, null, \"Spring의 \", React.createElement(_components.code, null, \"StreamMessageListenerContainer\"), \"를 활용하여\\nListener의 생명주기를 명시적으로 관리\"), \"\\n\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"java\\\"><pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">container<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">start</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\ncontainer<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">stop</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"메시지 발송이 필요한 구간에서만 Consumer를 활성화하고, 불필요한 리소스 사용을 줄이는 방향으로 개선할 계획이다.\"), \"\\n\", React.createElement(_components.h2, null, \"배운 점\"), \"\\n\", React.createElement(_components.ol, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"트랜잭션 경계를 명확히 해야 한다\"), \": 특히 메시징 시스템과 DB를 함께 사용할 때 트랜잭션 커밋 시점이 중요하다.\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"Redis 직렬화는 명시적으로\"), \": Template 타입에 따라 serializer가 달라질 수 있으므로 주의해야 한다.\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"분산 시스템의 예외 처리\"), \": 예외로 인한 서비스 중단보다는 재처리 가능한 구조가 더 안정적이다.\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"메시지큐 설정의 중요성\"), \": pollTimeout, batchSize 같은 설정값이 처리량과 분배에 큰 영향을 미친다.\"), \"\\n\"));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\n","import GATSBY_COMPILED_MDX from \"/home/runner/work/aaxx98.github.io/aaxx98.github.io/content/til/20260119/til-20260119.mdx\";\nimport * as React from 'react';\nimport Layout from '../../components/layout';\nimport Comment from '../../components/post/comment';\nimport PostContent from '../../components/post/post-content';\nimport PostTags from '../../components/post/post-tags';\nimport Seo from '../../components/seo';\nimport CollapsibleTOC from '../../components/post/toc';\nfunction BlogPost(_ref) {\n  let {data, children} = _ref;\n  return React.createElement(Layout, null, React.createElement(PostContent, {\n    data: data\n  }), React.createElement(\"section\", {\n    className: \"post-body-container\"\n  }, React.createElement(CollapsibleTOC, null), React.createElement(\"div\", {\n    className: \"post-body\"\n  }, children), React.createElement(\"div\", {\n    className: \"post-tags-area\"\n  }, React.createElement(PostTags, {\n    tags: data.mdx.frontmatter.tags,\n    isLinked: true\n  })), React.createElement(\"div\", {\n    className: \"post-top-wrap\"\n  }, React.createElement(\"button\", {\n    onClick: () => window.scrollTo({\n      top: 0,\n      behavior: 'smooth'\n    }),\n    className: \"post-top-button\",\n    \"aria-label\": \"\\uB9E8 \\uC704\\uB85C \\uC774\\uB3D9\"\n  }, \"\\u2191 TOP\"))), React.createElement(\"section\", {\n    className: \"comment-section\"\n  }, React.createElement(Comment, null)));\n}\nconst query = \"3479210645\";\nexport function Head(_ref2) {\n  let {data} = _ref2;\n  return React.createElement(Seo, {\n    title: data.mdx.frontmatter.title\n  });\n}\nBlogPost\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(BlogPost, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\n","import * as React from 'react';\n\nimport Breadcrumb from '../breadcrumb';\n\nfunction PostContent({ data }: any) {\n  return (\n    <div className=\"post-content-container\">\n      <h1 className=\"post-content-title\">{data.mdx.frontmatter.title}</h1>\n      <p className=\"post-content-meta\">작성일: {data.mdx.frontmatter.date}</p>\n      <div className=\"breadcrumb-wrap\">\n        <Breadcrumb\n          info={[\n            { name: 'HOME', url: '/' },\n            {\n              name: `${data.mdx.frontmatter.category}`,\n              url: `/categories/${data.mdx.frontmatter.category}`,\n            },\n            {\n              name: data.mdx.frontmatter.title,\n              url: `/${data.mdx.frontmatter.slug}`,\n            },\n          ]}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default PostContent;\n","import React, { useState, useEffect } from 'react';\n\ninterface TocItem {\n  id: string;\n  text: string;\n  level: number;\n  element: HTMLElement;\n}\n\nconst CollapsibleTOC = () => {\n  const [isOpen, setIsOpen] = useState<boolean>(false);\n  const [tocItems, setTocItems] = useState<TocItem[]>([]);\n\n  useEffect(() => {\n    const headings = document.querySelectorAll<HTMLHeadingElement>('h1, h2, h3, h4, h5, h6');\n    const items: TocItem[] = Array.from(headings).map((heading, index) => {\n      if (!heading.id) {\n        heading.id = `heading-${index}`;\n      }\n\n      return {\n        id: heading.id,\n        text: heading.textContent || '',\n        level: parseInt(heading.tagName.charAt(1), 10),\n        element: heading,\n      };\n    });\n\n    setTocItems(items);\n  }, []);\n\n  const scrollToHeading = (id: string) => {\n    const element = document.getElementById(id);\n    if (element) {\n      const headerOffset = 80;\n      const elementPosition = element.offsetTop;\n      const offsetPosition = elementPosition - headerOffset;\n\n      window.scrollTo({\n        top: offsetPosition,\n        behavior: 'smooth',\n      });\n    }\n  };\n\n  if (tocItems.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"toc-container\">\n      <button\n        className=\"toc-toggle\"\n        onClick={() => setIsOpen(!isOpen)}\n        aria-expanded={isOpen}\n        aria-controls=\"toc-content\"\n      >\n        <span className=\"toc-title\">목차</span>\n        <span className={`toc-arrow ${isOpen ? 'open' : ''}`}>▼</span>\n      </button>\n\n      <div id=\"toc-content\" className={`toc-content ${isOpen ? 'open' : ''}`}>\n        <nav className=\"toc-nav\">\n          <ul className=\"toc-list\">\n            {tocItems.map((item) => (\n              <li key={item.id} className={`toc-item level-${item.level} `}>\n                <button\n                  className=\"toc-link\"\n                  onClick={() => scrollToHeading(item.id)}\n                  title={item.text}\n                >\n                  {item.text}\n                </button>\n              </li>\n            ))}\n          </ul>\n        </nav>\n      </div>\n    </div>\n  );\n};\n\nexport default CollapsibleTOC;\n","const tagNames: Record<string, string> = {\n  gatsby: 'Gatsby',\n  react: 'React',\n  utterances: 'Utterances',\n  github: 'Github',\n  blog: '블로그',\n  seo: 'SEO',\n  'tailwind-css': 'Tailwind CSS',\n  bootcamp: '부트캠프후기',\n  'multi-campus': '멀티캠퍼스IT부트캠프',\n  'ureca-backend': 'LG U+ 유레카 3기 백엔드',\n  java: 'JAVA',\n  study: '스터디',\n  database: '데이터베이스',\n  sql: 'SQL',\n  conccurency: '동시성',\n  redis: 'Redis',\n};\nexport default tagNames;\n","import * as React from 'react';\n\nimport { faAngleRight } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { Link } from 'gatsby';\n\ntype BreadcrumbProps = {\n  info: { name: string; url: string }[];\n};\n\nexport default function Breadcrumb({ info }: BreadcrumbProps) {\n  if (!info || info.length === 0) return null;\n\n  return (\n    <nav aria-label=\"breadcrumb\" className=\"breadcrumb\">\n      <ol className=\"breadcrumb-list\">\n        {info.map((item, idx) => {\n          const isLast = idx === info.length - 1;\n          return (\n            <li key={item.url || `${item.name}-${idx}`} className=\"breadcrumb-item\">\n              {isLast ? (\n                <span aria-current=\"page\" className=\"breadcrumb-current\">\n                  {item.name}\n                </span>\n              ) : (\n                <Link to={item.url} className=\"breadcrumb-link\">\n                  {item.name}\n                </Link>\n              )}\n              {!isLast && (\n                <span className=\"breadcrumb-sep\">\n                  <FontAwesomeIcon icon={faAngleRight} className=\"breadcrumb-sep-icon\" />\n                </span>\n              )}\n            </li>\n          );\n        })}\n      </ol>\n    </nav>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\n\nfunction Comment() {\n  const containerRef = useRef<HTMLDivElement | null>(null);\n  const [status, setStatus] = useState<'pending' | 'success' | 'failed'>('pending');\n\n  useEffect(() => {\n    const el = containerRef.current;\n    if (!el) return;\n\n    el.innerHTML = '';\n\n    const script = document.createElement('script');\n    script.src = 'https://utteranc.es/client.js';\n    script.async = true;\n    script.crossOrigin = 'anonymous';\n    script.setAttribute('repo', 'aaxx98/aaxx98.github.io');\n    script.setAttribute('issue-term', 'pathname');\n    script.setAttribute('theme', 'github-dark');\n\n    script.onload = () => setStatus('success');\n    script.onerror = () => setStatus('failed');\n\n    el.appendChild(script);\n\n    return () => {\n      el.innerHTML = '';\n    };\n  }, []);\n\n  return (\n    <section className=\"comment-container\" aria-label=\"댓글\">\n      {status === 'failed' && (\n        <div className=\"comment-status error\">\n          댓글을 불러오는 중 오류가 발생했습니다. 새로고침 후 다시 시도해주세요.\n        </div>\n      )}\n      {status === 'pending' && <div className=\"comment-status pending\">댓글을 불러오는 중...</div>}\n      <div ref={containerRef} className=\"utterances-container\" />\n    </section>\n  );\n}\n\nexport default Comment;\n","import * as React from 'react';\n\nimport { Link } from 'gatsby';\n\nimport tagNames from '../../code/tagName';\n\ntype PostTagProps = {\n  tags: string[];\n  isLinked?: boolean;\n};\n\nfunction PostTags({ tags, isLinked = false }: PostTagProps) {\n  return (\n    <div className=\"post-tags\">\n      {tags.map((tag: string) =>\n        isLinked ? (\n          <Link key={tag} to={`/tags/${tag}`} className=\"post-tag\">\n            #{tagNames[tag] || tag}\n          </Link>\n        ) : (\n          <div key={tag} className=\"post-tag\">\n            #{tagNames[tag] || tag}\n          </div>\n        ),\n      )}\n    </div>\n  );\n}\n\nexport default PostTags;\n"],"names":["_createMdxContent","props","_components","Object","assign","h2","p","ul","li","strong","h3","span","h4","ol","code","_provideComponents","components","React","dangerouslySetInnerHTML","__html","start","wrapper","MDXLayout","BlogPost","_ref","data","children","Layout","PostContent","className","CollapsibleTOC","PostTags","tags","mdx","frontmatter","isLinked","onClick","window","scrollTo","top","behavior","Comment","Head","_ref2","Seo","title","GatsbyMDXWrapper","GATSBY_COMPILED_MDX","date","Breadcrumb","info","name","url","category","slug","isOpen","setIsOpen","useState","tocItems","setTocItems","useEffect","headings","document","querySelectorAll","items","Array","from","map","heading","index","id","text","textContent","level","parseInt","tagName","charAt","element","length","item","key","getElementById","headerOffset","offsetPosition","offsetTop","scrollToHeading","gatsby","react","utterances","github","blog","seo","bootcamp","java","study","database","sql","conccurency","redis","idx","isLast","Link","to","FontAwesomeIcon","icon","faAngleRight","containerRef","useRef","status","setStatus","el","current","innerHTML","script","createElement","src","async","crossOrigin","setAttribute","onload","onerror","appendChild","ref","tag","tagNames"],"sourceRoot":""}