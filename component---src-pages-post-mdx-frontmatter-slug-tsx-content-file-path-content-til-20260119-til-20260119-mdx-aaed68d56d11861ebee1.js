"use strict";(self.webpackChunkaaxx98_blog=self.webpackChunkaaxx98_blog||[]).push([[621],{5083:function(n,e,a){a.r(e),a.d(e,{Head:function(){return g},default:function(){return k}});var t=a(8453),s=a(6540);function l(n){const e=Object.assign({h2:"h2",p:"p",ul:"ul",li:"li",strong:"strong",h3:"h3",span:"span",h4:"h4",ol:"ol",code:"code"},(0,t.RP)(),n.components);return s.createElement(s.Fragment,null,s.createElement(e.h2,null,"배경"),"\n",s.createElement(e.p,null,"메시지 발송 시스템에서 대량의 메시지를 효율적으로 처리하기 위해 Redis Stream을 메시지큐로 활용하고, Docker 컨테이너를 통해 4개의 Consumer를 병렬로 운영하는 구조를 구축했다. 이 과정에서 발생한 여러 문제들과 해결 과정을 정리한다."),"\n",s.createElement(e.h2,null,"아키텍처 개요"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"Producer"),": Spring 애플리케이션에서 메시지 발송 요청을 Redis Stream에 발행(admin-web)"),"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"Consumer"),": 4개의 Docker 컨테이너에서 각각 실행되며 메시지를 병렬 처리(message-sender)"),"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"메시지큐"),": Redis Stream (Consumer Group 방식)"),"\n"),"\n",s.createElement(e.h3,null,"Docker을 이용하여 환경 구성"),"\n",s.createElement(e.p,null,"다음과 같이 실행하면 Consumer를 여러 개 실행시킬 수 있다."),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">docker compose up -d --build --scale message-sender=4</code></pre></div>'}}),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/5fc6e8a1a470e11c2c47849ca2dddd95/e113d/4message-sender.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 38.5%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVR42nWRiW6CQBCGff+nq2nRBFRwF/c+BPZitUmHo5LYdLKZwIYv3/zD7pNiJO/FVR6xPtHOx/TIowuJWQ+H3z21PsQ0zpVS4pxrrXPO8LprtMRcF2d8abnt3DhOtyElMwTVB90H0wO7wlDdXCuchlDf5L7CmIo8xjxfL2Z4+n7m5yO/yBijEMI5t8JnxRA3RSMOSFakAww+9iGB0w5wIvSXGcY2xmzmUlLM1Akx8DMzQLo8Z17Sgv8tM5i3zF+sBfOh4WWrrqL3YVsYNRNJrfsXrrUg0laIg5mYwcfJDDuHhZk+wijQf9k/Y38QVBOxL1FxIUjCZuexfSLG3Yxb+tuvUkot8A/f/8Qijma4hwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/5fc6e8a1a470e11c2c47849ca2dddd95/f1512/4message-sender.webp 200w,\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/f59aa/4message-sender.webp 400w,\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/47a22/4message-sender.webp 800w,\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/5bb53/4message-sender.webp 1200w,\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/3a8da/4message-sender.webp 1364w"\n              sizes="(max-width: 800px) 100vw, 800px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/5fc6e8a1a470e11c2c47849ca2dddd95/f8f3a/4message-sender.png 200w,\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/6a8a8/4message-sender.png 400w,\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/7842b/4message-sender.png 800w,\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/5ece7/4message-sender.png 1200w,\n/static/5fc6e8a1a470e11c2c47849ca2dddd95/e113d/4message-sender.png 1364w"\n            sizes="(max-width: 800px) 100vw, 800px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/5fc6e8a1a470e11c2c47849ca2dddd95/7842b/4message-sender.png"\n            alt="message-sender=4"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n  </a>\n    </span>'}}),"\n",s.createElement(e.h2,null,"발생한 문제와 해결 과정"),"\n",s.createElement(e.h3,null,"1. 트랜잭션 타이밍 이슈: Race Condition"),"\n",s.createElement(e.h4,null,"문제 흐름"),"\n",s.createElement(e.ol,null,"\n",s.createElement(e.li,null,"Producer가 DB에 메시지 상태 저장 (커밋 이전)"),"\n",s.createElement(e.li,null,"Redis Stream에 메시지 발행"),"\n",s.createElement(e.li,null,"Consumer가 메시지를 읽고 DB 조회 시도"),"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"커밋 전이라 데이터가 없어서 예외 발생")," → 컨테이너 종료 및 재시작"),"\n",s.createElement(e.li,null,"4개 컨테이너가 각각 한 번씩 재시작되며 초기 4건의 미처리 발생"),"\n"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"\n",s.createElement(e.p,null,"메시지 처리 중, userId 별 메시지 상태 데이터를 Insert하며 ",s.createElement(e.code,null,"streamProducer.publish")," 발행"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"requestMessage가 종료되면 트랜잭션이 종료되어 메세지 상태 결과가 DB에 반영됨"),"\n"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">  <span class="token annotation punctuation">@Transactional</span>\n<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">requestMessage</span><span class="token punctuation">(</span><span class="token class-name">Long</span> messageReservationId<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">markProcessing</span><span class="token punctuation">(</span>messageReservationId<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token class-name">MessageReservation</span> reservation <span class="token operator">=</span>\n      messageReservationRepository<span class="token punctuation">.</span><span class="token function">findByIdWithRelations</span><span class="token punctuation">(</span>messageReservationId<span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n\n  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Long</span> userId <span class="token operator">:</span> userIds<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token class-name">MessageSendResult</span> result <span class="token operator">=</span> messageSendResultRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>\n        <span class="token class-name">MessageSendResult</span><span class="token punctuation">.</span><span class="token function">createFrom</span><span class="token punctuation">(</span>reservation<span class="token punctuation">,</span> userId<span class="token punctuation">,</span> waitingStatus<span class="token punctuation">)</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    streamProducer<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> channelTypeCode<span class="token punctuation">,</span> purposeTypeCode<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">markSent</span><span class="token punctuation">(</span>reservation<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n"),"\n",s.createElement(e.li,null,"\n",s.createElement(e.p,null,"Consumer에서는 위 트랜잭션이 끝나기 전, Stream에 전송된 메세지들을 읽으려고 시도하지만, Commit 되지 않았기 때문에 메세지 상태 정보를 찾을 수 없음 → 예외 발생 및 컨테이너가 종료되고 재실행됨"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"예외 발생시 애플리케이션 종료되는 이유: Redis Listener에서 예외를 처리하여 종료되고있음"),"\n"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token class-name">MessageRequestDto</span> dto<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\n\t<span class="token class-name">MessageSendResult</span> result <span class="token operator">=</span>\n        messageSendResultRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">getMessageSendResultId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"메시지 없음"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n"),"\n",s.createElement(e.li,null,"\n",s.createElement(e.p,null,"그 결과, 각 message-sender 컨테이너가 한번씩 재실행되며 초기 4건의 미처리가 발생하는것으로 추측됨"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"code_id = 7: WAITING(발송 대기)"),"\n",s.createElement(e.li,null,"code_id = 8: SUCCESS(발송 성공)\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/69c4c67639999f15b7e92116b10e4f56/4ed45/status7.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 31%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKUlEQVR42h2OW0+DQBCF+f//xPigDzYxpi/eqj5oL0rZArVCodKydFl2l70B62AyOflmknPOeHP0c6h4hpusZHnF/0fkJU1O7Optf/1+vHzeXTzEt2s2WZGbRXm3UU8xTQtyosp7maNKdOe2p9qV3AJg0QFj3n/kZvHbT+fp5DWcxfQ+wNPl/jFuZqjAzDTaef46aKRl0rZmqIVmyjbSCNMDsFarboh3yXoT7dLMR2FelMoO5ZkSLqUdzagWlrYd0+7MNRGGSuABFFamhmCbroI4SnLQfVHJ3p0Ir5gSozlAUMtVB0mN0E2ruRq/gAtwa4fwO/XH5oOPovyIde8w4bVQqnPeYvn5/3bXGldzDQNZQvegwEIP4Tb5QtE2yUGzAoOnJJwwJa37AyL9SishpZWTAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/69c4c67639999f15b7e92116b10e4f56/f1512/status7.webp 200w,\n/static/69c4c67639999f15b7e92116b10e4f56/f59aa/status7.webp 400w,\n/static/69c4c67639999f15b7e92116b10e4f56/47a22/status7.webp 800w,\n/static/69c4c67639999f15b7e92116b10e4f56/5bb53/status7.webp 1200w,\n/static/69c4c67639999f15b7e92116b10e4f56/ff1f5/status7.webp 1330w"\n              sizes="(max-width: 800px) 100vw, 800px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/69c4c67639999f15b7e92116b10e4f56/f8f3a/status7.png 200w,\n/static/69c4c67639999f15b7e92116b10e4f56/6a8a8/status7.png 400w,\n/static/69c4c67639999f15b7e92116b10e4f56/7842b/status7.png 800w,\n/static/69c4c67639999f15b7e92116b10e4f56/5ece7/status7.png 1200w,\n/static/69c4c67639999f15b7e92116b10e4f56/4ed45/status7.png 1330w"\n            sizes="(max-width: 800px) 100vw, 800px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/69c4c67639999f15b7e92116b10e4f56/7842b/status7.png"\n            alt="초기 4건의 미처리"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n  </a>\n    </span>'}})),"\n"),"\n"),"\n"),"\n",s.createElement(e.h4,null,"해결방법: ",s.createElement(e.code,null,"TransactionSynchronizationManager"),"를 활용해 트랜잭션 커밋 후에 메시지 발행"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"afterCommit 콜백에서 publish 처리","\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"afterCommit: 커밋 정상처리 후 실행되는 메소드"),"\n"),"\n"),"\n"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Transactional</span>\n<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">requestMessage</span><span class="token punctuation">(</span><span class="token class-name">Long</span> messageReservationId<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">markProcessing</span><span class="token punctuation">(</span>messageReservationId<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token class-name">MessageReservation</span> reservation <span class="token operator">=</span>\n      messageReservationRepository<span class="token punctuation">.</span><span class="token function">findByIdWithRelations</span><span class="token punctuation">(</span>messageReservationId<span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n\n  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">></span></span> resultIds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 이후 메시지 발송을 위해 발송상태ID 저장</span>\n\n  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Long</span> userId <span class="token operator">:</span> userIds<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token class-name">MessageSendResult</span> result <span class="token operator">=</span> messageSendResultRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>\n        <span class="token class-name">MessageSendResult</span><span class="token punctuation">.</span><span class="token function">createFrom</span><span class="token punctuation">(</span>reservation<span class="token punctuation">,</span> userId<span class="token punctuation">,</span> waitingStatus<span class="token punctuation">)</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    resultIds<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token class-name">TransactionSynchronizationManager</span><span class="token punctuation">.</span><span class="token function">registerSynchronization</span><span class="token punctuation">(</span>\n      <span class="token keyword">new</span> <span class="token class-name">TransactionSynchronization</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token annotation punctuation">@Override</span>\n        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Long</span> resultId <span class="token operator">:</span> resultIds<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            streamProducer<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>resultId<span class="token punctuation">,</span> channelTypeCode<span class="token punctuation">,</span> purposeTypeCode<span class="token punctuation">)</span><span class="token punctuation">;</span>\n          <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">markSent</span><span class="token punctuation">(</span>reservation<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n",s.createElement(e.h3,null,"2. ACK 처리 실패: Serializer 불일치"),"\n",s.createElement(e.h4,null,"문제 원인"),"\n",s.createElement(e.p,null,"모든 메시지가 Pending 상태에서 ACK 처리가 되지 않았다. Redis Stream에서 ACK가 성공하려면 stream key, group, messageId가 정확히 일치해야 하는데, ",s.createElement(e.code,null,"RedisTemplate<String, Object>")," 사용 시 serializer가 명시적으로 설정되지 않아 바이트 레벨에서 불일치가 발생했다."),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 428px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/pending-all.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxklEQVR42pWQSwuDMBCE/f+/zIMB9aCCSmNiHhof+EBQrHawWHoq6RyWLJuPmV3nQamQIs/zoiiyLGOMpWlKKTXGaK2llE3T4IGqlEKLWlXVeclhXGilgiDwfT9JEkIIxhgcx/G8dNz6bm+Ysbqu4zgG6Xme67pRFA3DcFrI6bpuWRakQqQwDMuy5JyjtYKnaVrXFeZg4AwYsbHwHzB+gycegX/f94jzWewXPM/ztm0g4YnY4hLOawvv+9627Xtnc2kcR5vYL9gtx6XaTQYXAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/1296033dcf31d027e3e1fe598dd22eb4/f1512/pending-all.webp 200w,\n/static/1296033dcf31d027e3e1fe598dd22eb4/f59aa/pending-all.webp 400w,\n/static/1296033dcf31d027e3e1fe598dd22eb4/477b5/pending-all.webp 428w"\n              sizes="(max-width: 428px) 100vw, 428px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/1296033dcf31d027e3e1fe598dd22eb4/f8f3a/pending-all.png 200w,\n/static/1296033dcf31d027e3e1fe598dd22eb4/6a8a8/pending-all.png 400w,\n/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/pending-all.png 428w"\n            sizes="(max-width: 428px) 100vw, 428px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/pending-all.png"\n            alt="Pending 메시지 전 건"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n  </a>\n    </span>'}}),"\n",s.createElement(e.h4,null,"해결 방법: ",s.createElement(e.code,null,"StringRedisTemplate"),"로 변경하여 올바른 serializer가 기본 설정되도록 함"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"변경 전: ",s.createElement(e.code,null,"RedisTemplate<String, Object>")),"\n",s.createElement(e.li,null,"변경 후: ",s.createElement(e.code,null,"StringRedisTemplate")," 사용"),"\n"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">redisTemplate<span class="token punctuation">.</span><span class="token function">opsForStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">acknowledge</span><span class="token punctuation">(</span>\n    message<span class="token punctuation">.</span><span class="token function">getStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    group<span class="token punctuation">,</span>\n    message<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 352px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/242cd314fe218e01a68c46287ae972f0/ff9f2/ack.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 52.5%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCklEQVR42o2SV4+DQAyE+f8/jibCBg4BohfRJEQv+S6Rck8X4gdrbe14xrMr+b4fRVGapp7nGYbRNE0QBLZtZ1kmy7Lrunmevztccxyn7/vzPI/jkNq2zZ+hqmqSJPMyD8NAc5qmbdv2fV/XdVkWSjLlPM/k8xkSXZiLojBN8y7uhPPjQPUef/4fEvPQU1XVjTBuqELFZ8wfGBls8mLWdZ0lx3H8FozsOI7LsgQshMA/BrEn+Fe+kI1OwIqiWJaF4b/yDQPzUQH+ExiR2IO9mqZBDoYMvq5r5l7I7rouDEOuQitMwRnlDKJ/7fbre+A2XwLbEcIjsQWvfW0YnGDgwS2WxC1Kvsc3bj8AW4FxBpUSZ4IAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/242cd314fe218e01a68c46287ae972f0/f1512/ack.webp 200w,\n/static/242cd314fe218e01a68c46287ae972f0/5da75/ack.webp 352w"\n              sizes="(max-width: 352px) 100vw, 352px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/242cd314fe218e01a68c46287ae972f0/f8f3a/ack.png 200w,\n/static/242cd314fe218e01a68c46287ae972f0/ff9f2/ack.png 352w"\n            sizes="(max-width: 352px) 100vw, 352px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/242cd314fe218e01a68c46287ae972f0/ff9f2/ack.png"\n            alt="전 건 ACK 처리됨"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n  </a>\n    </span>'}}),"\n",s.createElement(e.h2,null,"최적화 과정"),"\n",s.createElement(e.h3,null,"각 Consumer 별 메시지 분배를 균등하게 개선"),"\n",s.createElement(e.h4,null,"초기 문제"),"\n",s.createElement(e.p,null,"각 메시지 처리에 소요되는 시간은 1초인데, pollTimeout을 5초로 설정했더니 메시지가 균등하게 분배되지 않았다."),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"message-sender-1: 1건"),"\n",s.createElement(e.li,null,"message-sender-2: 1건"),"\n",s.createElement(e.li,null,"message-sender-3: N-3건"),"\n",s.createElement(e.li,null,"message-sender-4: 1건"),"\n"),"\n",s.createElement(e.p,null,"한 번 대기 상태에 빠진 Consumer는 계속 대기하는 경향이 있었다."),"\n",s.createElement(e.h3,null,"개선"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"\n",s.createElement(e.ol,null,"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"pollTimeout 조정"),": 5초 → 500ms로 단축"),"\n"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"여전히 각 consumer 별 pending 메시지는 균일하게 분배되지 않음"),"\n",s.createElement(e.li,null,"onMessage에서 각 메세지 발송을 처리하기 전 우선 처리할 메시지를 consumer가 선점하고있음\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 393px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/3202a7e4e00854e9c227fda6df290b92/8a54c/poll-timeout.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 50.5%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAUlEQVR42o2Sx26FUAxE+f8vY4UIuSKI3lsAUV4JouU8rhQlqzALyxd5PB4bxfd913WDIEiTVNO0uqqLoqiqqizKJEn6vs/znHgcx77vx18onueZpuk4DkW6rkPLsiwMw7Is27blSWya5vMEH6sT5PRS4jiGJt6F9WFFUSSEYJZpmp4nxnH8OkFOvIH77QHujxc5TVOkVFU1DANlJrdte57n4wIUHDKYHBWyZVmsgI7btkmf0upP/P1U1nVlFjy8hheCpOs6OkryP8oU4VCSjTejrmu5G5peIg/DQDXbwjD7JEd5WZaryghCYGesmoQWl5Sxzg24JNfDMwfnl6DdFc/fFCY3QJuzBMcAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/3202a7e4e00854e9c227fda6df290b92/f1512/poll-timeout.webp 200w,\n/static/3202a7e4e00854e9c227fda6df290b92/84562/poll-timeout.webp 393w"\n              sizes="(max-width: 393px) 100vw, 393px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/3202a7e4e00854e9c227fda6df290b92/f8f3a/poll-timeout.png 200w,\n/static/3202a7e4e00854e9c227fda6df290b92/8a54c/poll-timeout.png 393w"\n            sizes="(max-width: 393px) 100vw, 393px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/3202a7e4e00854e9c227fda6df290b92/8a54c/poll-timeout.png"\n            alt="pollTimeout 조정 후"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n  </a>\n    </span>'}})),"\n"),"\n"),"\n",s.createElement(e.li,null,"\n",s.createElement(e.ol,{start:"2"},"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"batchSize 설정"),": 10으로 설정하여 10건씩 균일하게 할당"),"\n"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"batch로 묶여있으면 1건 처리 실패 시 batch 단위가 재처리 대상이 되므로 실패율을 고려해 10건으로 설정"),"\n",s.createElement(e.li,null,"각 consumer가 10건씩 할당받고, 순차적으로 처리 후 균일하게 할당됨\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 428px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/batch10.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxklEQVR42pWQSwuDMBCE/f+/zIMB9aCCSmNiHhof+EBQrHawWHoq6RyWLJuPmV3nQamQIs/zoiiyLGOMpWlKKTXGaK2llE3T4IGqlEKLWlXVeclhXGilgiDwfT9JEkIIxhgcx/G8dNz6bm+Ysbqu4zgG6Xme67pRFA3DcFrI6bpuWRakQqQwDMuy5JyjtYKnaVrXFeZg4AwYsbHwHzB+gycegX/f94jzWewXPM/ztm0g4YnY4hLOawvv+9627Xtnc2kcR5vYL9gtx6XaTQYXAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/1296033dcf31d027e3e1fe598dd22eb4/f1512/batch10.webp 200w,\n/static/1296033dcf31d027e3e1fe598dd22eb4/f59aa/batch10.webp 400w,\n/static/1296033dcf31d027e3e1fe598dd22eb4/477b5/batch10.webp 428w"\n              sizes="(max-width: 428px) 100vw, 428px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/1296033dcf31d027e3e1fe598dd22eb4/f8f3a/batch10.png 200w,\n/static/1296033dcf31d027e3e1fe598dd22eb4/6a8a8/batch10.png 400w,\n/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/batch10.png 428w"\n            sizes="(max-width: 428px) 100vw, 428px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/1296033dcf31d027e3e1fe598dd22eb4/ce704/batch10.png"\n            alt="batchSize 10으로 설정 후"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n  </a>\n    </span>'}})),"\n"),"\n"),"\n"),"\n",s.createElement(e.h2,null,"추가 고려사항 및 향후 개선 방향"),"\n",s.createElement(e.h3,null,"메시지 상태 초기 저장 시 CPU 사용량 이슈"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 513px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/fd73846fdae503c0e899f76153e54966/bb9ec/cpu.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 85.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMklEQVR42o1T227bMAz1///EXvcP20uKPWXYuiVNuqSObcmy5Xusu+x46CjJKTCgDxUIibF0eMhDJpr8en197ft+s9n8evy53+2+b7fTB1aklB5H/uVyTOrmKaE/XsjjCzni5kNgY61SBl275spOafF8wX8u+cDkPM/hhXXb/D54TXtZuDTncowrhjoutYNYv2YHte+iI7hGCBljm7rGWTZNZujbyyUGCRhjGGOI87DdJZguywKPQyYrWEo59MMIdXM+XK9KqTfOkDVkEVNOB7nc3Fr8AUXBfVRV1X6/P53OZVmCD1Emf7GaD7DcpmWeORfDyJuBA4+UjiMCwjRNIW2tDZjSRkglpRbC7dL50j2WmtZdXrVn0tOqgVxBUAfOsgyuAwaUVz4EtPBuEM7Mk3nKeVYzoyQDbY1ZmZMkVY7EP9XW41ekVkYrK4WerTkQnlTiBiqotRkwJCqO45EBM5gLAXf3hIOjuVCT0c9kPJFxMgYqCmo6MNRcdoKLQG6kM+VCeB/4A/hYsHPJgBA4fC88M9RMOw5qGW0sTByo5wQ0qwOflf472wNh54KBo7UO7XRDQiktO6iHk1YUvcw7SWFvBVhacdwK3AjSiR0ej4SRXqJmHcEIOg69RQjHSZYinJdVXlCUkywvEClTTFBe4IIm8ImULSUVJXU7+CGxERxCCJhEAbpztpr7GYwLUOPuPxzar7+r8TqE+XN/DMCHifPOes7/r5u3z9vh07e279rQ53/52sDOvn34CAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/fd73846fdae503c0e899f76153e54966/f1512/cpu.webp 200w,\n/static/fd73846fdae503c0e899f76153e54966/f59aa/cpu.webp 400w,\n/static/fd73846fdae503c0e899f76153e54966/c7c13/cpu.webp 513w"\n              sizes="(max-width: 513px) 100vw, 513px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/fd73846fdae503c0e899f76153e54966/f8f3a/cpu.png 200w,\n/static/fd73846fdae503c0e899f76153e54966/6a8a8/cpu.png 400w,\n/static/fd73846fdae503c0e899f76153e54966/bb9ec/cpu.png 513w"\n            sizes="(max-width: 513px) 100vw, 513px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/fd73846fdae503c0e899f76153e54966/bb9ec/cpu.png"\n            alt="CPU 사용량"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n  </a>\n    </span>'}}),"\n",s.createElement(e.p,null,"메시지 발송 요청 시, 대략 2만건 이상의 대량의 메시지 상태를 한 번에 저장하는 과정에서 CPU 사용량이 급격히 증가하는 문제가 확인되었다."),"\n",s.createElement(e.p,null,"이에 따라 메시지 상태 초기 저장 및 Stream 발행 책임을 어느 컴포넌트에서 처리할지에 대한 구조적 검토가 필요하다."),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"admin-web에서 즉시 처리"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"API 응답 지연 및 CPU 부하 집중 가능성"),"\n"),"\n"),"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"별도 batch 성격의 컴포넌트(billing-batch)에서 처리"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"예약 발송, 재시도 처리와 함께 순차적(batch) 처리 가능"),"\n",s.createElement(e.li,null,"시스템 부하 분산 측면에서 유리"),"\n"),"\n"),"\n"),"\n",s.createElement(e.h3,null,"처리 속도 및 처리량 한계"),"\n",s.createElement(e.p,null,"메시지 전송 지연을 1초로 가정할 경우, 단일 Consumer는 약 10초에 9건 수준의 처리량을 보였으며, 100만 건 처리 시 약 12.9일이 소요되는 것으로 계산되었다."),"\n",s.createElement(e.p,null,"Consumer를 4개로 확장하더라도 약 3.23일이 소요되어, 대량 처리 환경에서는 추가적인 처리량 개선이 필요하다."),"\n",s.createElement(e.p,null,"이를 위해 다음과 같은 개선 방향을 검토 중이다."),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"Batch Insert 및 Redis Pipeline 적용을 통한 RTT 감소"),"\n",s.createElement(e.li,null,"Consumer 내부 스레드 병렬 처리"),"\n",s.createElement(e.li,null,"Consumer 컨테이너 수 조절"),"\n",s.createElement(e.li,null,"pollTimeout, batchSize 등 Stream 설정값 튜닝"),"\n"),"\n",s.createElement(e.h3,null,"message-sender 컨테이너 실행 시점 관리 필요성"),"\n",s.createElement(e.p,null,"현재 구조에서는 message-sender 컨테이너가 항상 Redis Stream을 polling하는 형태로 동작한다."),"\n",s.createElement(e.p,null,"그러나 실제 메시지 발송이 발생하는 시간대가 제한적인 경우, 불필요한 polling으로 인한 리소스 낭비가 발생할 수 있다."),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"메시지 발송이 없는 시간대에도 지속적인 poll 수행"),"\n",s.createElement(e.li,null,"CPU 및 Redis 부하 증가 가능성"),"\n"),"\n",s.createElement(e.p,null,"이에 따라 다음과 같은 방식의 개선을 고려하고 있다."),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"예약 발송 또는 재전송 요청이 발생하는 시점에만 Consumer 활성화")),"\n",s.createElement(e.li,null,"Spring의 ",s.createElement(e.code,null,"StreamMessageListenerContainer"),"를 활용하여\nListener의 생명주기를 명시적으로 관리"),"\n"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">container<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\ncontainer<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre></div>'}}),"\n",s.createElement(e.p,null,"메시지 발송이 필요한 구간에서만 Consumer를 활성화하고, 불필요한 리소스 사용을 줄이는 방향으로 개선할 계획이다."),"\n",s.createElement(e.h2,null,"배운 점"),"\n",s.createElement(e.ol,null,"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"트랜잭션 경계를 명확히 해야 한다"),": 특히 메시징 시스템과 DB를 함께 사용할 때 트랜잭션 커밋 시점이 중요하다."),"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"Redis 직렬화는 명시적으로"),": Template 타입에 따라 serializer가 달라질 수 있으므로 주의해야 한다."),"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"분산 시스템의 예외 처리"),": 예외로 인한 서비스 중단보다는 재처리 가능한 구조가 더 안정적이다."),"\n",s.createElement(e.li,null,s.createElement(e.strong,null,"메시지큐 설정의 중요성"),": pollTimeout, batchSize 같은 설정값이 처리량과 분배에 큰 영향을 미친다."),"\n"))}var c=function(n){void 0===n&&(n={});const{wrapper:e}=Object.assign({},(0,t.RP)(),n.components);return e?s.createElement(e,n,s.createElement(l,n)):l(n)},p=a(7082),o=a(8009),i=a(5606),u=a(8454),r=a(1042),m=a(6952);function d(n){let{data:e,children:a}=n;return s.createElement(p.A,null,s.createElement(i.A,{data:e}),s.createElement("section",{className:"post-body-container"},s.createElement(m.A,null),s.createElement("div",{className:"post-body"},a),s.createElement("div",{className:"post-tags-area"},s.createElement(u.A,{tags:e.mdx.frontmatter.tags,isLinked:!0})),s.createElement("div",{className:"post-top-wrap"},s.createElement("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"post-top-button","aria-label":"맨 위로 이동"},"↑ TOP"))),s.createElement("section",{className:"comment-section"},s.createElement(o.A,null)))}function g(n){let{data:e}=n;return s.createElement(r.A,{title:e.mdx.frontmatter.title})}function k(n){return s.createElement(d,n,s.createElement(c,n))}},5606:function(n,e,a){var t=a(6540),s=a(7962);e.A=function(n){let{data:e}=n;return t.createElement("div",{className:"post-content-container"},t.createElement("h1",{className:"post-content-title"},e.mdx.frontmatter.title),t.createElement("p",{className:"post-content-meta"},"작성일: ",e.mdx.frontmatter.date),t.createElement("div",{className:"breadcrumb-wrap"},t.createElement(s.A,{info:[{name:"HOME",url:"/"},{name:`${e.mdx.frontmatter.category}`,url:`/categories/${e.mdx.frontmatter.category}`},{name:e.mdx.frontmatter.title,url:`/${e.mdx.frontmatter.slug}`}]})))}},6952:function(n,e,a){var t=a(6540);e.A=()=>{const{0:n,1:e}=(0,t.useState)(!1),{0:a,1:s}=(0,t.useState)([]);(0,t.useEffect)((()=>{const n=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),e=Array.from(n).map(((n,e)=>(n.id||(n.id=`heading-${e}`),{id:n.id,text:n.textContent||"",level:parseInt(n.tagName.charAt(1),10),element:n})));s(e)}),[]);return 0===a.length?null:t.createElement("div",{className:"toc-container"},t.createElement("button",{className:"toc-toggle",onClick:()=>e(!n),"aria-expanded":n,"aria-controls":"toc-content"},t.createElement("span",{className:"toc-title"},"목차"),t.createElement("span",{className:"toc-arrow "+(n?"open":"")},"▼")),t.createElement("div",{id:"toc-content",className:"toc-content "+(n?"open":"")},t.createElement("nav",{className:"toc-nav"},t.createElement("ul",{className:"toc-list"},a.map((n=>t.createElement("li",{key:n.id,className:`toc-item level-${n.level} `},t.createElement("button",{className:"toc-link",onClick:()=>(n=>{const e=document.getElementById(n);if(e){const n=80,a=e.offsetTop-n;window.scrollTo({top:a,behavior:"smooth"})}})(n.id),title:n.text},n.text))))))))}},7717:function(n,e){e.A={gatsby:"Gatsby",react:"React",utterances:"Utterances",github:"Github",blog:"블로그",seo:"SEO","tailwind-css":"Tailwind CSS",bootcamp:"부트캠프후기","multi-campus":"멀티캠퍼스IT부트캠프","ureca-backend":"LG U+ 유레카 3기 백엔드",java:"JAVA",study:"스터디",database:"데이터베이스",sql:"SQL",conccurency:"동시성",redis:"Redis"}},7962:function(n,e,a){a.d(e,{A:function(){return p}});var t=a(6540),s=a(6188),l=a(2337),c=a(4794);function p(n){let{info:e}=n;return e&&0!==e.length?t.createElement("nav",{"aria-label":"breadcrumb",className:"breadcrumb"},t.createElement("ol",{className:"breadcrumb-list"},e.map(((n,a)=>{const p=a===e.length-1;return t.createElement("li",{key:n.url||`${n.name}-${a}`,className:"breadcrumb-item"},p?t.createElement("span",{"aria-current":"page",className:"breadcrumb-current"},n.name):t.createElement(c.Link,{to:n.url,className:"breadcrumb-link"},n.name),!p&&t.createElement("span",{className:"breadcrumb-sep"},t.createElement(l.g,{icon:s.vmR,className:"breadcrumb-sep-icon"})))})))):null}},8009:function(n,e,a){var t=a(6540);e.A=function(){const n=(0,t.useRef)(null),{0:e,1:a}=(0,t.useState)("pending");return(0,t.useEffect)((()=>{const e=n.current;if(!e)return;e.innerHTML="";const t=document.createElement("script");return t.src="https://utteranc.es/client.js",t.async=!0,t.crossOrigin="anonymous",t.setAttribute("repo","aaxx98/aaxx98.github.io"),t.setAttribute("issue-term","pathname"),t.setAttribute("theme","github-dark"),t.onload=()=>a("success"),t.onerror=()=>a("failed"),e.appendChild(t),()=>{e.innerHTML=""}}),[]),t.createElement("section",{className:"comment-container","aria-label":"댓글"},"failed"===e&&t.createElement("div",{className:"comment-status error"},"댓글을 불러오는 중 오류가 발생했습니다. 새로고침 후 다시 시도해주세요."),"pending"===e&&t.createElement("div",{className:"comment-status pending"},"댓글을 불러오는 중..."),t.createElement("div",{ref:n,className:"utterances-container"}))}},8454:function(n,e,a){var t=a(6540),s=a(4794),l=a(7717);e.A=function(n){let{tags:e,isLinked:a=!1}=n;return t.createElement("div",{className:"post-tags"},e.map((n=>a?t.createElement(s.Link,{key:n,to:`/tags/${n}`,className:"post-tag"},"#",l.A[n]||n):t.createElement("div",{key:n,className:"post-tag"},"#",l.A[n]||n))))}}}]);
//# sourceMappingURL=component---src-pages-post-mdx-frontmatter-slug-tsx-content-file-path-content-til-20260119-til-20260119-mdx-aaed68d56d11861ebee1.js.map